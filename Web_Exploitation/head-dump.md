# PicoCTF 2025 - head-dump Challenge Write-Up

## Challenge Overview:
- **Category:** Web Exploitation
- **Difficulty:** Easy

The objective of this challenge was to uncover a hidden flag within a server's memory dump by exploiting a web application’s **API endpoint**. In this case, the web application exposed an endpoint that allowed a memory dump of the server to be downloaded. Our goal was to analyze the contents of the dump and find the flag.

---

## Initial Analysis:

Upon launching the challenge, I was provided with the following instructions:

The goal was clear: explore the web application, find the memory dump endpoint, and extract the flag hidden in the server’s memory. After loading the site, I noticed an article titled **API Documentation**, which redirected me to the `/api-docs` page. This page displayed the available API routes, which included a route for generating a memory dump.

---

## Exploitation Process:

### 1. Identifying the Critical Endpoint

I opened the API documentation and found an endpoint named `/heapdump` under the **Diagnosing** section. The description indicated that this endpoint generates a memory dump of the server. This immediately caught my attention as it directly aligned with the challenge name.

### 2. Executing the Endpoint

Using Swagger UI’s **Try it out** feature, I triggered the `/heapdump` endpoint. This resulted in a download of a `.heapsnapshot` file containing the server’s memory data. This file is a memory dump of the server's heap, which could potentially contain sensitive information like the flag.

![Swagger UI](insert_image_link_here)

### 3. Analyzing the Memory Dump

After downloading the memory dump, I realized that the file was large and unstructured, making it difficult to manually search for the flag. To address this, I used **command-line tools** to analyze the file.

I ran the following command to search for the flag:

```bash
cat heapdump-1742808189103.heapsnapshot | grep "picoCTF"

This allowed me to quickly identify the flag within the dump without manually sifting through massive amounts of data.

4. Extracting the Flag

The grep command pinpointed the flag within the memory dump, which appeared in the following format:

picoCTF{Pat****_15_***_***_*******4}

Technical Insight:

    Memory Dump Analysis: The key issue here was the exposure of sensitive information through a memory dump. Memory dumps contain data from the server’s memory, which can include passwords, secrets, and in this case, the flag.

    API Endpoint Misconfiguration: The /heapdump endpoint was accessible via the Swagger UI, and anyone with access to the documentation could trigger a memory dump, exposing sensitive data without authentication. This misconfiguration serves as a reminder of how important it is to secure API endpoints that expose sensitive server data.

    Efficient File Parsing: Given the large size of the dump, using tools like grep allowed me to efficiently search for the flag instead of manually reviewing the entire dump.

Key Skills Demonstrated:

    Web Exploitation: The ability to identify and exploit poorly secured API endpoints was critical in solving this challenge. This demonstrates a solid understanding of how to interact with web APIs and how misconfigured endpoints can lead to data leaks.

    Memory Dump Analysis: By analyzing the memory dump file, I showcased the ability to work with unstructured data and extract meaningful information, a skill that can be applied in real-world scenarios like incident response or digital forensics.

    Command-Line Tools: The use of grep for searching through large data sets is a valuable skill for efficiently extracting information from files, especially when dealing with large logs or dumps.

Lessons Learned:

    API Security: The challenge reinforced the importance of securing API endpoints, particularly those that expose sensitive data like memory dumps. Always ensure that such endpoints are either secured or disabled in production environments.

    Handling Large Files: The challenge highlighted the importance of using command-line tools to parse large files quickly and efficiently. For cybersecurity professionals, knowing how to handle and analyze large datasets is a crucial skill.

    Data Exposure: This challenge served as a reminder of how critical it is to safeguard against unnecessary data exposure, whether through misconfigured API routes or vulnerable debugging tools.

Final Flag:

picoCTF{Pat****_15_***_***_*******4}

Conclusion:

Successfully solving the head-dump challenge demonstrates a strong understanding of web application vulnerabilities and how misconfigured API endpoints can lead to significant data exposure. By identifying the vulnerable endpoint, analyzing the memory dump, and extracting the flag, I demonstrated skills in API exploitation, memory analysis, and data parsing.

This skill set is highly applicable to roles in penetration testing, red team exercises, and security analysis, where identifying and exploiting such vulnerabilities is crucial.
Tools Used:

    Swagger UI: For interacting with the API and triggering the memory dump.

    grep: For efficiently searching through the memory dump file.

    Command-line tools: For analyzing the dump file.
