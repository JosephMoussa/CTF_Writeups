# PicoCTF 2025 - SSTI1 Challenge Write-Up

## Challenge Overview:
- **Category:** Web Exploitation
- **Difficulty:** Easy

The objective of this challenge was to exploit a **Server-Side Template Injection (SSTI)** vulnerability in a web application. SSTI occurs when user input is unsafely injected into a server-side template, which is then rendered and evaluated. In this case, the challenge involved interacting with a vulnerable web app that accepted user input without proper sanitization.

---

## Initial Analysis:

Upon launching the challenge, I was provided with the following instructions:
- **Find This Room:** SSTI1
- **Say:** Thank You

From the provided hint, the vulnerability type (**SSTI**) was clear. **SSTI** allows an attacker to inject code into the server's template engine, which will be executed when the template is rendered. Knowing that Jinja2 is a common template engine used with Python Flask, I began testing with basic **Jinja2 expressions** to check for execution.

---

## Exploitation Process:

### 1. Testing for Jinja2 Template Injection

I started by entering the following basic expression in the input field:

{{ 7 * 7 }}


When the application processed this input, it returned `49`. This confirmed that the server uses **Jinja2** for template rendering, and that the input is being evaluated directly by the template engine. This behavior indicates an **SSTI vulnerability** and opens the door for further exploitation.

### 2. Enumerating the Server's File System

The next step was to exploit this vulnerability further. I used the following Jinja2 expression to execute a command on the server:

{{request.application.globals.builtins.import('os').popen('ls -R').read()}}


This command lists all directories recursively using Python’s `os.popen()` function. The response returned a list of the server’s file structure, which gave insight into potential files containing sensitive information.

### 3. Extracting the Flag

Based on the output from the previous step, I modified the command to directly read the contents of the **flag** file:

{{request.application.globals.builtins.import('os').popen('cat flag').read()}}


The server responded with the contents of the file, revealing the **flag** in the following format:

picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_df9a00a0}


With this, the challenge was successfully completed.

---

## Technical Insight:

- **SSTI Vulnerability:** The core issue here was **improper input sanitization**. The application failed to escape or sanitize the user input before embedding it in the Jinja2 template. This allowed arbitrary code execution through template injection.
  
- **Command Execution:** By exploiting the SSTI vulnerability, I was able to execute arbitrary Python code on the server, including executing shell commands like `ls` to enumerate directories and `cat` to read files.

- **Template Engine (Jinja2):** The challenge specifically tested knowledge of **Jinja2** template syntax and how it can be abused for **remote code execution** (RCE) via **SSTI**. Understanding the **request object** and accessing server globals like `__import__` and `__builtins__` were key to exploiting this vulnerability.

---

## Key Skills Demonstrated:

- **Web Exploitation**: The ability to identify and exploit web vulnerabilities, specifically **SSTI**, is a crucial skill in **cybersecurity**. This challenge required a deep understanding of how web applications process user input and how malicious input can lead to server-side code execution.
  
- **Python & Jinja2**: Knowledge of **Jinja2 templates** and how Python’s **`os.popen()`** function works was essential for bypassing the server’s security and extracting sensitive data.

- **Command Injection & Remote Code Execution (RCE)**: Successfully exploiting **command injection** via **SSTI** to gain access to the file system demonstrates a solid grasp of **RCE techniques**, which are often targeted in **web application penetration testing**.

---

## Lessons Learned:

- **Input Sanitization**: The challenge reinforced the importance of **proper input validation and sanitization** to prevent template injection attacks. Ensuring that user input is safely handled can prevent attackers from executing arbitrary code or accessing sensitive files.
  
- **Template Engine Security**: It's critical for developers to be aware of the dangers of embedding untrusted input in template engines, especially in Python-based web frameworks like **Flask** that use **Jinja2**.

- **Privilege Escalation**: This challenge demonstrated how an attacker can escalate privileges on a server by abusing vulnerabilities in seemingly innocent user input fields.

---

## Final Flag:

picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_df9a00a0}


---

## Conclusion:

Successfully solving this challenge demonstrates a strong understanding of **web application vulnerabilities**, specifically in the area of **Server-Side Template Injection (SSTI)**. In real-world scenarios, vulnerabilities like SSTI are often exploited in **penetration tests** or **red team exercises**, making this skillset crucial for roles such as **security consultant**, **pen tester**, and **SOC analyst**.

By identifying the vulnerability, exploiting it through **Jinja2 injection**, and extracting the flag, I showcased a range of **technical skills** including vulnerability identification, exploitation, and server-side code execution.

---

## Tools Used:
- **Jinja2 Templating Engine**: For crafting and testing template injections.
- **Python's os module**: For executing system commands on the server.

---
